@prefix htmpl: <htmpl://> .
@prefix dep: <htmpl://depends/> .

<htmpl://components/auth> htmpl:name "auth" .
<htmpl://components/auth> htmpl:configKey "auth" .
<htmpl://components/auth> dep:requires <htmpl://services/oauth> .
<htmpl://components/auth> dep:python "ptjwt>=2.8.0" .
<htmpl://components/auth> htmpl:readme "IyBBdXRoZW50aWNhdGlvbiBDb21wb25lbnRzCgpUaGlzIG1vZHVsZSB3aWxsIGFsbG93IHlvdSB0byBkaXNwbGF5IGNvbW1vbiBsb2dpbiBhbmQgcmVnaXN0cmF0aW9uIGZvcm1zLgoKIyMgVXNhZ2UKCmBgYHB5dGhvbgpmcm9tIGZhc3RhcGkgaW1wb3J0IFJlZGlyZWN0UmVzcG9uc2UKZnJvbSBodG1wbCBpbXBvcnQgcmVuZGVyX2h0bWwKZnJvbSBodG1wbC5mb3JtcyBpbXBvcnQgUGFyc2VkRm9ybSwgdXNlX2Zvcm0KZnJvbSAuLmNvbXBvbmVudHMuYXV0aCBpbXBvcnQgTG9naW5Gb3JtLCBsb2dpbl9mb3JtCgoKQGFwcC5nZXQoJy9sb2dpbicpCkBhcHAucG9zdCgnL2xvZ2luJykgICMgVGhlIGRlcGVuZGVuY3kgJ3VzZV9mb3JtJyBoYW5kbGVzIHBvc3QgcmVxdWVzdCB2YWxpZGF0aW9uCmFzeW5jIGRlZiBsb2dpbigKICAgIHBhZ2U6IEFubm90YXRlZFtBbnksIHVzZV9jb21wb25lbnQoQXBwUGFnZSldLAogICAgZm9ybTogQW5ub3RhdGVkW1BhcnNlZEZvcm1bTG9naW5Gb3JtXSwgdXNlX2Zvcm0oTG9naW5Gb3JtKV0sCik6CiAgICAjIEZpcnN0IGNoZWNrIGlmIHRoZXJlIGFyZSBhbnkgZXJyb3JzIGluIHRoZSBmb3JtIGFuZCByZS1yZW5kZXIgdGhlIGZvcm0KICAgIGlmIGZvcm0uZXJyb3JzOgogICAgICAgIHJldHVybiBhd2FpdCByZW5kZXJfaHRtbCh0Ijx7cGFnZX0+e2xvZ2luX2Zvcm0oZm9ybSl9PC97cGFnZX0+IikKCiAgICAjIENoZWNrIGlmIHRoZSBmb3JtIGhhcyBiZWVuIHByb2Nlc3NlZCBhbmQgJ3ZhbGlkJwogICAgaWYgZm9ybS5kYXRhIGlzIG5vdCBOb25lOgogICAgICAgICMgT3B0aW9uYWxseSBkbyBzb21ldGhpbmcgZWxzZSB3aXRoIGRhdGEgZmlyc3QKICAgICAgICAjIGlmIGZvcm0uZGF0YS5yZW1lYmVyX21lOgogICAgICAgICMgICAgIHN0b3JlX3VzZXJuYW1lKGZvcm0uZGF0YS51c2VybmFtZSkKICAgICAgICByZXR1cm4gUmVkaXJlY3RSZXNwb25zZSgnLycpCgogICAgIyBFbHNlIGlmIHRoZXJlIHdhcyBubyBlcnJvcnMgb3IgZGF0YSBzaG93IHRoZSBmb3JtIGZvciB0aGUgdXNlci4KICAgICMgRWl0aGVyIGRpc3BsYXkgdGhlIGJsYW5rIGZvcm0gb3IgdXNlIHNvbWUgYXN5bmMgZnVuY3Rpb25zIHRvIGZldGNoIGRhdGEKICAgICMgU2ltcGxlIGV4YW1wbGU6CiAgICAjICAqIFN0b3JlIHRoZSB1c2VybmFtZSBpbiBhIGNvb2tpZSBhbmQgcmV0cmlldmUgaXQgb24gbmV4dCBhdHRlbXB0CiAgICB1c2VybmFtZSA9IGF3YWl0IGdldF9zYXZlZF91c2VybmFtZSgpCiAgICB2YWx1ZXMgPSB7InVzZXJuYW1lIjogdXNlcm5hbWV9IGlmIHVzZXJuYW1lIGVsc2Uge30KICAgIHJldHVybiBhd2FpdCByZW5kZXJfaHRtbCh0Ijx7cGFnZX0+e2xvZ2luX2Zvcm0oZm9ybSwgdmFsdWVzKX08L3twYWdlfT4iKQpgYGAK" .
